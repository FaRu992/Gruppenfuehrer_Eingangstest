<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Gruppenführer – Eingangstest (Lernmodus)</title>

  <!-- iOS "Web-App" (muss im HEAD stehen) -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="GF-Quiz">

  <style>
    :root{
      --bg:#0b0f14; --card:#121926; --text:#e9eef6; --muted:#a9b4c3;
      --ok:#22c55e; --warn:#f59e0b; --bad:#ef4444; --line:#243044;
      --btn:#1f2a3d; --btn2:#243044;
    }
    body{ margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; background:var(--bg); color:var(--text); }
    .wrap{ max-width:980px; margin:0 auto; padding:18px; }
    header{ display:flex; flex-wrap:wrap; gap:12px; align-items:flex-end; justify-content:space-between; margin-bottom:14px; }
    h1{ font-size:20px; margin:0; }
    .sub{ color:var(--muted); font-size:13px; margin-top:6px; line-height:1.35; }
    .controls{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    button, select{
      background:var(--btn); color:var(--text); border:1px solid var(--line);
      padding:10px 12px; border-radius:10px; cursor:pointer; font-weight:600;
    }
    select{ cursor:pointer; }
    button.secondary{ background:transparent; }
    button:hover, select:hover{ background:var(--btn2); }
    .panel{ background:var(--card); border:1px solid var(--line); border-radius:14px; padding:14px; }

    .tabs{ display:flex; gap:10px; flex-wrap:wrap; margin:10px 0 14px; }
    .tabbtn{ border-radius:999px; padding:9px 12px; }
    .tabbtn.active{ outline:2px solid rgba(255,255,255,0.10); background:rgba(255,255,255,0.04); }

    .meta{ display:flex; gap:12px; flex-wrap:wrap; align-items:center; justify-content:space-between; margin:10px 0 14px; }
    .badge{
      display:inline-flex; align-items:center; gap:8px; padding:8px 10px;
      border-radius:999px; border:1px solid var(--line); background:rgba(255,255,255,0.02);
      color:var(--muted); font-size:13px;
    }
    .traffic{ font-weight:800; }
    .traffic.red{ color:var(--bad); }
    .traffic.yellow{ color:var(--warn); }
    .traffic.green{ color:var(--ok); }

    .q{ padding:14px; border-radius:14px; border:1px solid var(--line); background:rgba(255,255,255,0.02); margin-bottom:12px; }
    .qhead{ display:flex; gap:10px; justify-content:space-between; align-items:flex-start; }
    .qno{ color:var(--muted); font-weight:700; min-width:58px; }
    .qtext{ font-weight:700; line-height:1.35; flex:1; }
    .src{ color:var(--muted); font-size:12px; margin-top:6px; }
    .opts{ margin-top:10px; display:grid; gap:8px; }
    label.opt{
      display:flex; gap:10px; align-items:flex-start;
      padding:10px; border:1px solid var(--line); border-radius:12px; cursor:pointer;
      background:rgba(0,0,0,0.10);
    }
    label.opt:hover{ background:rgba(255,255,255,0.04); }
    input[type="radio"]{ margin-top:2px; }
    .fb{ margin-top:10px; padding:10px; border-radius:12px; border:1px dashed var(--line); display:none; }
    .fb.ok{ display:block; border-color:rgba(34,197,94,0.5); }
    .fb.bad{ display:block; border-color:rgba(239,68,68,0.5); }
    .fb .t{ font-weight:800; }
    .fb .t.ok{ color:var(--ok); }
    .fb .t.bad{ color:var(--bad); }
    .fb .e{ margin-top:6px; color:var(--muted); line-height:1.35; }
    .result{ margin-top:14px; }
    .result h2{ margin:0 0 8px; font-size:16px; }
    .small{ color:var(--muted); font-size:13px; line-height:1.35; }
    .hr{ height:1px; background:var(--line); margin:12px 0; border:0; }
    .toggle{
      display:inline-flex; align-items:center; gap:8px; user-select:none;
      padding:8px 10px; border-radius:12px; border:1px solid var(--line);
      background:rgba(255,255,255,0.02); color:var(--muted); font-size:13px;
    }

    /* Lernteil */
    .learn{ display:none; }
    .learn.active{ display:block; }
    .learngrid{ display:grid; gap:12px; }
    .learncard{
      border:1px solid var(--line); border-radius:14px; background:rgba(255,255,255,0.02);
      padding:12px;
    }
    details{
      border:1px solid var(--line); border-radius:14px; background:rgba(0,0,0,0.10); padding:10px;
    }
    summary{ cursor:pointer; font-weight:800; }
    ul{ margin:8px 0 0 18px; color:var(--muted); line-height:1.5; }
    .check{ display:flex; gap:10px; align-items:flex-start; margin-top:8px; color:var(--muted); }
    .check input{ margin-top:4px; }
    .hint{ color:var(--muted); font-size:12px; margin-top:8px; line-height:1.35; }
  </style>
</head>

<body>
<div class="wrap">
  <header>
    <div>
      <h1>Gruppenführer – Eingangstest (Simulation)</h1>
      <div class="sub">
        Wahl zwischen <b>16 Zufallsfragen (Prüfmodus)</b> und <b>vollständigem Fragenpool</b>.
        Zusätzlich: <b>Lernteil</b> mit „das muss ich können“-Checkliste.
      </div>
      <div class="sub" style="margin-top:8px;">
        © <span id="year"></span> Fabian Russ • Feuerwehr Eschenbach
      </div>
    </div>

    <div class="controls">
      <select id="scope">
        <option value="random16" selected>16 Fragen (zufällig)</option>
        <option value="all">Kompletter Fragenpool</option>
      </select>

      <select id="mode">
        <option value="exam" selected>Prüfmodus (Feedback erst am Ende)</option>
        <option value="learn">Lernmodus (Feedback sofort)</option>
      </select>

      <label class="toggle" title="Reihenfolge mischen (bei 16 Zufallsfragen ohnehin zufällig)">
        <input id="shuffle" type="checkbox" checked />
        Reihenfolge mischen
      </label>

      <button onclick="startQuiz()">Quiz starten</button>
      <button class="secondary" onclick="resetAll()">Reset</button>
    </div>
  </header>

  <div class="panel">
    <div class="tabs">
      <button id="tabQuiz" class="tabbtn active" onclick="showTab('quiz')">Quiz</button>
      <button id="tabLearn" class="tabbtn" onclick="showTab('learn')">Lernteil</button>
    </div>

    <div id="quizTab">
      <div class="meta">
        <div class="badge">Status: <span id="statusText">bereit</span></div>
        <div class="badge">Punkte: <span id="scoreText">0</span> / <span id="totalText">0</span></div>
        <div class="badge">Ampel:
          <span id="traffic" class="traffic red">ROT</span>
        </div>
      </div>

      <div id="quiz"></div>

      <div class="result" id="result" style="display:none;">
        <hr class="hr" />
        <h2>Auswertung</h2>
        <div class="small" id="summary"></div>
        <div class="small" style="margin-top:10px;">
          Ampellogik: <b>Grün ≥ 90%</b>, <b>Gelb 70–89%</b>, <b>Rot &lt; 70%</b>.
        </div>
      </div>
    </div>

    <div id="learnTab" class="learn">
      <div class="learngrid">
        <div class="learncard">
          <div style="font-weight:900; font-size:15px;">Lernplan – „Das muss ich können“</div>
          <div class="hint">
            Ziel: Jede Rubrik so beherrschen, dass du sie als Gruppenführer in 30–60 Sekunden erklären
            oder als Befehl formulieren kannst.
          </div>
        </div>

        <details open>
          <summary>FwDV 3 (Gruppe) – Einsatzablauf, Befehle, Bereitstellung</summary>
          <ul>
            <li>Einsatzablauf Gruppe im Lösch- und Hilfeleistungseinsatz erklären (wer macht was, wann, warum).</li>
            <li>Befehl strukturiert geben (Lage – Auftrag – Mittel – Weg – Ziel).</li>
            <li>„Mit Bereitstellung“: ausrüsten, bereit halten, keine Eigeninitiative ohne Befehl.</li>
          </ul>
          <label class="check"><input type="checkbox"> Ich kann einen vollständigen Gruppenführer-Befehl fehlerfrei formulieren.</label>
          <label class="check"><input type="checkbox"> Ich kann „Bereitstellung“ + typische Einsatzanlässe erklären.</label>
        </details>

        <details>
          <summary>FwDV/DV 810 – Funk: Aufbau, Grundsätze, TMO/DMO</summary>
          <ul>
            <li>Funkspruch-Aufbau: Gegenstelle – von – eigener Rufname – Nachricht – „Kommen“.</li>
            <li>Grundsätzlich Gruppenruf; Einzelruf nur, wenn taktisch zwingend.</li>
            <li>TMO (Netzbetrieb) bevorzugt; DMO bei taktischer Notwendigkeit oder unzureichender Versorgung.</li>
            <li>Rufgruppenwechsel nur auf Weisung; kurze, präzise Sprache.</li>
          </ul>
          <label class="check"><input type="checkbox"> Ich kann einen korrekten Funkspruch inkl. Empfangsbestätigung absetzen.</label>
          <label class="check"><input type="checkbox"> Ich kann TMO/DMO praxisnah erklären (wann nutze ich was?).</label>
        </details>

        <details>
          <summary>FwDV 7 / AGT – Grundsätze Atemschutz</summary>
          <ul>
            <li>Truppweise vorgehen, Eigensicherung, Rückzugsweg, Kommunikation.</li>
            <li>Sicherheitstrupp: Aufgabe & Bereitstellung.</li>
            <li>Verhalten bei Atemkrise/Stress: stehen bleiben, ruhig/tief atmen, melden.</li>
          </ul>
          <label class="check"><input type="checkbox"> Ich kenne Abbruch-/Notfallindikatoren und kann die Reaktion erklären.</label>
        </details>

        <details>
          <summary>FwDV 10 – Tragbare Leitern</summary>
          <ul>
            <li>Anstellwinkel 65–75°; sichere Auflagepunkte; Leiterfuß sichern; Verkehrswege absichern.</li>
            <li>Überstand: mind. 1 m / 3 Sprossen (wenn keine gleichwertige Haltemöglichkeit).</li>
            <li>Kommandos durch den Truppführer.</li>
          </ul>
          <label class="check"><input type="checkbox"> Ich kann Anstellwinkel/Überstand und die Begründung nennen.</label>
        </details>

        <details>
          <summary>FwDV 2 – Brennen & Löschen / Löschmittelwahl</summary>
          <ul>
            <li>Verbrennungsvoraussetzungen: Brennstoff – Sauerstoff – Zündenergie; bei Flüssigkeiten brennen Dämpfe.</li>
            <li>Löschmittelwahl nach Brandklasse (insb. Fettbrandklasse F).</li>
          </ul>
          <label class="check"><input type="checkbox"> Ich kann Brandklassen + passendes Löschmittel begründen.</label>
        </details>

        <details>
          <summary>Gefahren an Einsatzstellen – AAAACEEEE</summary>
          <ul>
            <li>Gefahren systematisch erkennen/benennen und Maßnahmen ableiten.</li>
            <li>Grundmuster: Erkennen – Melden – Sichern.</li>
          </ul>
          <label class="check"><input type="checkbox"> Ich kann das Schema erklären und je Buchstabe 1–2 Maßnahmen nennen.</label>
        </details>

        <details>
          <summary>TH – Rettungsgrundsatz / Personenbetreuung</summary>
          <ul>
            <li>Rettungsgrundsatz (vollständig): Sichern – Zugang schaffen – lebensrettende Sofortmaßnahmen – Befreien – Übergabe RD.</li>
            <li>Umgang mit ansprechbaren/bewusstlosen Personen: Eigenschutz, Atemwege, Betreuung, Übergabe RD.</li>
          </ul>
          <label class="check"><input type="checkbox"> Ich kann den Rettungsgrundsatz auf einen VU anwenden (kurzes Vorgehensschema).</label>
        </details>

        <details>
          <summary>Bahnanlagen / Gefahrgut</summary>
          <ul>
            <li>Bahnanlagen: Zugverkehr einstellen lassen; Sicherheitsabstände; Oberleitung als Hochspannungsgefahr.</li>
            <li>Gefahrgut: GAMS (Gefahr erkennen – Absperren – Menschenrettung – Spezialkräfte) + Sofortdekontamination als Expositionsreduktion.</li>
          </ul>
          <label class="check"><input type="checkbox"> Ich kann „GAMS“ erklären und eine erste Maßnahmenkette formulieren.</label>
        </details>
      </div>
    </div>

  </div>
</div>

<script>
/* Jahreszahl */
const yearEl = document.getElementById("year");
if(yearEl) yearEl.textContent = new Date().getFullYear();

/**
 * Fragenpool (32)
 * - random16: zieht 16 zufällig
 * - all: kompletter Pool
 */

const QUESTIONS_POOL = [
  // ---------------- FwDV 3 (Kap. 5 / 5.4 / 5.5) ----------------
  {
    id: "q001",
    area: "FwDV 3 – Einsatzablauf Gruppe",
    source: "FwDV 3 Kap. 5",
    text: "Welche Maßnahme steht für den Gruppenführer nach dem Eintreffen grundsätzlich am Anfang?",
    options: [
      "Sofortiger Innenangriff ohne Erkundung",
      "Erkundung und Beurteilung der Lage",
      "Aufbau der Wasserversorgung durch den Gruppenführer",
      "Geräteablage ohne Auftrag"
    ],
    correct: 1,
    explain: "Der Gruppenführer startet mit der Erkundung, um Gefahren, Menschenrettung und taktische Möglichkeiten zu erkennen. Erst danach formuliert er einen passenden Befehl und setzt Schwerpunkte (z. B. Menschenrettung vor Brandbekämpfung)."
  },
  {
    id: "q002",
    area: "FwDV 3 – Einsatzablauf Gruppe",
    source: "FwDV 3 Kap. 5",
    text: "Wer bedient in der Gruppe im Regelfall die Feuerlöschkreiselpumpe?",
    options: ["Angriffstrupp", "Wassertrupp", "Schlauchtrupp", "Maschinist"],
    correct: 3,
    explain: "Die Pumpenbedienung ist Kernaufgabe des Maschinisten. Er stellt die Wasserversorgung sicher, überwacht Druck/Abgänge und unterstützt damit die Strahlrohrführung und das taktische Vorgehen."
  },
  {
    id: "q003",
    area: "FwDV 3 – Einsatzablauf Gruppe",
    source: "FwDV 3 Kap. 5",
    text: "Welche Reihenfolge beschreibt den Führungsvorgang im Einsatz in der Praxis am besten?",
    options: [
      "Erkundung – Entschluss/Befehl – Durchführung – Kontrolle",
      "Durchführung – Erkundung – Befehl – Kontrolle",
      "Befehl – Kontrolle – Erkundung – Durchführung",
      "Erkundung – Durchführung – Befehl – Kontrolle"
    ],
    correct: 0,
    explain: "Zuerst wird die Lage festgestellt (Erkundung), daraus folgt Entschluss und Befehl. Danach erfolgt die Umsetzung und fortlaufend die Kontrolle, ob die Maßnahmen wirken oder angepasst werden müssen."
  },
  {
    id: "q004",
    area: "FwDV 3 – Einsatzablauf Gruppe",
    source: "FwDV 3 Kap. 5",
    text: "Welche Aufgabe hat der Melder in der Gruppe typischerweise?",
    options: [
      "Pumpe bedienen",
      "Angriffstrupp ersetzen",
      "Unterstützung des Gruppenführers (Meldungen/Übermitteln/Organisieren)",
      "Wasserversorgung aufbauen"
    ],
    correct: 2,
    explain: "Der Melder unterstützt den Gruppenführer organisatorisch und im Meldewesen. Das kann das Weitergeben von Aufträgen, Rückmeldungen oder das Heranholen von Gerät/Informationen umfassen."
  },
  {
    id: "q005",
    area: "FwDV 3 – Einsatzablauf Gruppe",
    source: "FwDV 3 Kap. 5",
    text: "Wann müssen Trupps an den Gruppenführer zurückmelden?",
    options: [
      "Nur am Einsatzende",
      "Nach Durchführung des Auftrags oder bei wichtigen Lageänderungen",
      "Nur wenn der Gruppenführer nachfragt",
      "Ausschließlich per Funk"
    ],
    correct: 1,
    explain: "Rückmeldungen sind nötig, um die Lagebeurteilung aktuell zu halten. Besonders wichtig sind Auftragserfüllung, Hindernisse, Gefahren, Personengefährdung und jeder Abbruchgrund."
  },
  {
    id: "q006",
    area: "FwDV 3 – Befehl",
    source: "FwDV 3 Kap. 5.4/5.5",
    text: "Was ist ein wesentliches Merkmal von „Einsatz mit Bereitstellung“?",
    options: [
      "Sofortiger Innenangriff ohne weitere Befehle",
      "Kräfte/Trupps werden ausgerüstet und warten ohne Eigeninitiative auf Auftrag",
      "Bereitstellung findet grundsätzlich im Gefahrenbereich statt",
      "Bereitstellung bedeutet automatisch Rückbau"
    ],
    correct: 1,
    explain: "Bereitstellung heißt: Einsatzkräfte sind einsatzbereit positioniert, handeln aber nicht eigenständig ohne Befehl. Der Gruppenführer kann so flexibel nach Lageentwicklung Kräfte gezielt einsetzen."
  },
  {
    id: "q007",
    area: "FwDV 3 – Befehl",
    source: "FwDV 3 Kap. 5.4/5.5",
    text: "Welche Information muss ein Gruppenführer-Befehl mindestens enthalten?",
    options: [
      "Wetter, Uhrzeit, Fahrzeuge",
      "Einheit und Auftrag",
      "Nur die Lagebeschreibung",
      "Nur das Ziel"
    ],
    correct: 1,
    explain: "Mindestens müssen Empfänger (Einheit/Trupp) und Auftrag klar sein, damit überhaupt gehandelt werden kann. Je nach Lage werden weitere Elemente wie Mittel, Weg und Ziel ergänzt, damit der Auftrag eindeutig und sicher ausführbar ist."
  },
  {
    id: "q008",
    area: "FwDV 3 – Bereitstellung",
    source: "FwDV 3 Kap. 5.4/5.5",
    text: "Wo wird eine Bereitstellung sinnvoll eingerichtet?",
    options: [
      "Direkt im Gefahrenbereich (z. B. im Brandraum)",
      "In sicherem Bereich in einsatztaktisch sinnvoller Nähe",
      "Grundsätzlich am Feuerwehrhaus",
      "Immer hinter dem Einsatzleiterfahrzeug"
    ],
    correct: 1,
    explain: "Bereitstellung muss sicher sein (kein unmittelbarer Gefahrenbereich), aber so gelegen, dass Kräfte schnell eingesetzt werden können. Die Position richtet sich nach Zugangswegen, Gefahren und taktischem Schwerpunkt."
  },
  {
    id: "q009",
    area: "FwDV 3 – Bereitstellung",
    source: "FwDV 3 Kap. 5.4/5.5",
    text: "Welche Aufgabe hat der Gruppenführer während einer Bereitstellung vorrangig?",
    options: [
      "Keine – er wartet ebenfalls",
      "Lage beobachten, planen, Kräfte ordnen und Einsatzbereitschaft sicherstellen",
      "Nur Dokumentation schreiben",
      "Sofort Rückbau veranlassen"
    ],
    correct: 1,
    explain: "Der Gruppenführer nutzt die Bereitstellungsphase zur Lagebeobachtung, Vorbereitung und Koordination. Dazu gehören auch Sicherheitsaspekte (Absperrung/Fluchtwege) und ggf. Nachforderungen."
  },
  {
    id: "q010",
    area: "FwDV 3 – Befehl/Umsetzung",
    source: "FwDV 3 Kap. 5.5",
    text: "Welche Aussage beschreibt „keine Eigeninitiative“ in der Bereitstellung am besten?",
    options: [
      "Trupps dürfen eigenständig in den Innenangriff gehen, wenn sie sich sicher fühlen",
      "Trupps dürfen nur tätig werden, wenn ein Auftrag erteilt wurde oder eine unmittelbare Lebensgefahr abzuwehren ist",
      "Trupps dürfen ohne Befehl nur Geräte sortieren",
      "Trupps dürfen grundsätzlich nicht kommunizieren"
    ],
    correct: 1,
    explain: "Bereitstellung bedeutet grundsätzlich: Handeln erst nach Auftrag. Ausnahme ist die Abwehr akuter, unmittelbar drohender Gefahren (Eigensicherung/lebensrettende Sofortmaßnahmen), die nicht aufschiebbar sind."
  },

  // ---------------- DV 810 (Kap. 3 und 5) ----------------
  {
    id: "q011",
    area: "DV 810 – Funkspruchaufbau",
    source: "DV 810 Kap. 3/5",
    text: "Welche Reihenfolge ist bei einem standardisierten Funkspruch korrekt?",
    options: [
      "Eigener Rufname – Text – Gegenstelle",
      "Gegenstelle – von (eigener Rufname) – Nachricht – Kommen",
      "Nachricht – Gegenstelle – eigener Rufname – Ende",
      "Gegenstelle – Nachricht – Ende – eigener Rufname"
    ],
    correct: 1,
    explain: "Der Funkspruch beginnt mit der Gegenstelle, damit klar ist, wer angesprochen wird. Danach folgt „von …“ (eigener Rufname), anschließend die Nachricht und am Ende die Sprechaufforderung „Kommen“."
  },
  {
    id: "q012",
    area: "DV 810 – Funkdisziplin",
    source: "DV 810 Kap. 3",
    text: "Welcher Grundsatz gilt im BOS-Funk besonders?",
    options: [
      "Möglichst lange und detaillierte Funksprüche",
      "Umgangssprache und Dialekt sind erwünscht",
      "Kurz, klar, eindeutig – so knapp wie möglich, so vollständig wie nötig",
      "Mehrere Inhalte gleichzeitig sprechen, um Zeit zu sparen"
    ],
    correct: 2,
    explain: "Kurze, klare Funksprüche reduzieren Missverständnisse und halten den Kanal frei. Im Einsatz führt schlechte Funkdisziplin schnell zu Verzögerungen, Doppelmeldungen und Fehlern."
  },
  {
    id: "q013",
    area: "DV 810 – Betriebsarten",
    source: "DV 810 Kap. 3/5",
    text: "Welche Aussage zu TMO/DMO passt am besten?",
    options: [
      "DMO ist immer besser als TMO",
      "TMO ist Netzmodus, DMO ist Direktmodus ohne Netz (geräte-zu-geräte)",
      "TMO funktioniert nur im Gebäude, DMO nur im Freien",
      "DMO nutzt immer automatisch ein Relais"
    ],
    correct: 1,
    explain: "TMO (Netzbetrieb) läuft über die Infrastruktur und ist der Regelfall. DMO (Direktbetrieb) wird genutzt, wenn kein Netz verfügbar ist oder taktisch direkte Kommunikation erforderlich ist (z. B. in Objektfunk/Abschattung)."
  },
  {
    id: "q014",
    area: "DV 810 – Sprechgruppen",
    source: "DV 810 Kap. 3/5",
    text: "Was ist für einen Sprechgruppenwechsel im Einsatz grundsätzlich richtig?",
    options: [
      "Wechsel jederzeit nach eigenem Ermessen",
      "Wechsel nur auf Weisung bzw. nach festgelegtem Funkkonzept",
      "Wechsel ausschließlich durch den Maschinisten",
      "Wechsel ist im Digitalfunk nicht möglich"
    ],
    correct: 1,
    explain: "Sprechgruppenwechsel müssen koordiniert erfolgen, sonst gehen Einheiten „verloren“ und Meldungen erreichen die Führung nicht. Daher gilt: Wechsel nur nach Weisung oder nach klarer Funkordnung."
  },
  {
    id: "q015",
    area: "DV 810 – Meldungen",
    source: "DV 810 Kap. 5",
    text: "Wann ist es sinnvoll/erforderlich, eine Lagemeldung abzusetzen?",
    options: [
      "Nur nach Einsatzende",
      "Bei wesentlichen Lageänderungen oder wichtigen Feststellungen",
      "Nur wenn die Leitstelle danach fragt",
      "Nur wenn man eine Statusmeldung nicht senden kann"
    ],
    correct: 1,
    explain: "Lagemeldungen dienen der Führungsentscheidung und dem Nachführen von Kräften. Besonders wichtig sind Lageänderungen, Gefahren, Personenlage, Erfolg/Misserfolg von Maßnahmen und Ressourcenbedarf."
  },
  {
    id: "q016",
    area: "DV 810 – Verständlichkeit",
    source: "DV 810 Kap. 3",
    text: "Welche Maßnahme erhöht die Verständlichkeit eines Funkspruchs am meisten?",
    options: [
      "Sehr schnelle Sprechweise",
      "Viele Abkürzungen ohne Standard",
      "Kurze Sätze, Pausen, klare Struktur (wer/wo/was)",
      "Möglichst leise sprechen"
    ],
    correct: 2,
    explain: "Verständlichkeit entsteht durch Struktur und klare Sprache. Kurze Sätze und ein standardisiertes Muster (z. B. Lage–Maßnahme–Bedarf) verhindern Rückfragen und Fehlinterpretationen."
  },

  // ---------------- FwDV 7 (Kap. 7 und 9) ----------------
  {
    id: "q017",
    area: "FwDV 7 – Grundsatz",
    source: "FwDV 7 Kap. 7/9",
    text: "In welcher Mindeststärke wird ein Atemschutztrupp eingesetzt?",
    options: ["Einzelperson", "Trupp (2 Personen)", "Staffel", "Gruppe"],
    correct: 1,
    explain: "Atemschutz wird grundsätzlich truppweise eingesetzt. Das ermöglicht gegenseitige Hilfe, Kontrolle (z. B. bei Stress/Atemkrise) und erhöht die Sicherheit im Innenangriff."
  },
  {
    id: "q018",
    area: "FwDV 7 – Grundsatz",
    source: "FwDV 7 Kap. 7/9",
    text: "Welcher Grundsatz gilt für Atemschutztrupps im Einsatz zwingend?",
    options: [
      "Trupp darf sich bei Bedarf trennen",
      "Trupp bleibt zusammen und hält ständige Verbindung (Sicht/Leine/Funk je nach Lage)",
      "Truppführer geht immer allein vor",
      "Sprechen ist im Innenangriff zu vermeiden"
    ],
    correct: 1,
    explain: "Das Trennen des Trupps ist ein wesentlicher Sicherheitsverstoß. Zusammenbleiben und gesicherte Verbindung reduzieren das Risiko von Orientierungslosigkeit und ermöglichen schnelle Hilfe im Notfall."
  },
  {
    id: "q019",
    area: "FwDV 7 – Überwachung",
    source: "FwDV 7 Kap. 7/9",
    text: "Wozu dient die Atemschutzüberwachung primär?",
    options: [
      "Sie ersetzt die Einsatzdokumentation",
      "Sie überwacht Trupps/Zeiten/Status und unterstützt die Sicherheit (inkl. Notfallmanagement)",
      "Sie funkt nur Statusmeldungen an die Leitstelle",
      "Sie ist nur bei Übungen erforderlich"
    ],
    correct: 1,
    explain: "Atemschutzüberwachung stellt sicher, dass Trupps erfasst, kontrolliert und bei Problemen schnell erkannt werden. Sie ist ein wesentliches Sicherheitsinstrument, insbesondere bei mehreren Trupps oder unübersichtlichen Lagen."
  },
  {
    id: "q020",
    area: "FwDV 7 – Abbruchkriterien",
    source: "FwDV 7 Kap. 7/9",
    text: "Welcher Punkt ist ein typischer Abbruchgrund im Atemschutzeinsatz?",
    options: ["Gute Sicht", "Sinkender Luftvorrat/Reservegrenze erreicht", "Auftrag beginnt", "Trupp ist motiviert"],
    correct: 1,
    explain: "Sinkender Luftvorrat ist ein sicherheitskritischer Faktor: Rückweg und Reserve müssen gewährleistet sein. Abbruch ist auch bei Orientierungsverlust, Gerätedefekt, Verletzung oder gefährlicher Lageentwicklung geboten."
  },
  {
    id: "q021",
    area: "FwDV 7 – Verhalten in Notlagen",
    source: "FwDV 7 Kap. 7/9",
    text: "Wie reagiert man bei beginnender Atemkrise/Stress unter Atemschutz am sinnvollsten?",
    options: [
      "Sofort Maske abnehmen",
      "Weiterlaufen, um schneller rauszukommen",
      "Anhalten, beruhigen/Atmung kontrollieren, Lage melden, geordnet zurückziehen",
      "Hinlegen und warten, ohne zu melden"
    ],
    correct: 2,
    explain: "Atemkrise verschlechtert sich durch Hektik. Ziel ist: Ruhe herstellen, kontrolliert atmen, Kommunikation und geordneter Rückzug bzw. Unterstützung anfordern."
  },
  {
    id: "q022",
    area: "FwDV 7 – Personelle Voraussetzungen",
    source: "FwDV 7 (Allgemeine Anforderungen)",
    text: "Welche Aussage zu Anforderungen an Atemschutzgeräteträger ist richtig?",
    options: [
      "Mindestalter 16 Jahre genügt",
      "Körperliche Eignung wird einmalig festgestellt und gilt lebenslang",
      "Einsatz nur bei erfüllten persönlichen/medizinischen Voraussetzungen und Ausbildung",
      "Bart im Dichtbereich ist zulässig, wenn die Maske fest genug sitzt"
    ],
    correct: 2,
    explain: "Atemschutz setzt fachliche Ausbildung und gesundheitliche Eignung voraus. Faktoren wie fehlender Maskendichtsitz (z. B. Bart im Dichtbereich) sind Ausschlussgründe, weil sie die Schutzwirkung aufheben."
  },

  // ---------------- FwDV 10 (Kap. 4, 6, 7, 8) ----------------
  {
    id: "q023",
    area: "FwDV 10 – Anlegeleiter",
    source: "FwDV 10 Kap. 6",
    text: "Welche Mindestüberhöhung soll eine Anlegeleiter über die Austrittsstelle haben, wenn keine gleichwertige Haltemöglichkeit vorhanden ist?",
    options: ["0,5 m", "1 m / mindestens drei Sprossen", "2 m", "Keine Vorgabe"],
    correct: 1,
    explain: "Die Überhöhung (ca. 1 m bzw. mindestens drei Sprossen) schafft einen sicheren Haltebereich beim Übersteigen. Gibt es gleichwertige Haltemöglichkeiten (z. B. Geländer/Laibung), kann es ausreichen, wenn die Leiter bis zur Überstiegshöhe reicht."
  },
  {
    id: "q024",
    area: "FwDV 10 – Anstellwinkel",
    source: "FwDV 10 Kap. 6",
    text: "Welcher Anstellwinkel ist bei Anlegeleitern einzuhalten?",
    options: ["45°", "60°", "65–75°", "90°"],
    correct: 2,
    explain: "Der Winkel 65–75° ist ein Kompromiss aus Standfestigkeit und sicherem Steigen. Zu flach rutscht die Leiter leichter weg, zu steil steigt das Kipp-/Rutschrisiko und die Belastung am Leiterfuß."
  },
  {
    id: "q025",
    area: "FwDV 10 – Kommandos",
    source: "FwDV 10 Kap. 5",
    text: "Wer gibt bei der Vor- und Rücknahme tragbarer Leitern die Kommandos?",
    options: ["Gruppenführer", "Maschinist", "Truppführer", "Der erfahrenste Feuerwehrangehörige"],
    correct: 2,
    explain: "Die Kommandos gibt der Truppführer, der den Auftrag zur Leitervornahme vom Einheitsführer erhält. So sind klare Verantwortlichkeiten und ein einheitlicher Ablauf gewährleistet."
  },
  {
    id: "q026",
    area: "FwDV 10 – Steckleiter",
    source: "FwDV 10 Kap. 7",
    text: "Welche Aussage zur Vornahme der Steckleiter (durch drei Feuerwehrangehörige) ist richtig?",
    options: [
      "Es wird nur das benötigte Leiterteil vom Fahrzeug genommen",
      "Grundsätzlich werden alle Steckleiterteile entnommen und zur Anleiterstelle getragen",
      "Die Steckleiter wird immer im Fahrzeug zusammengesteckt",
      "Die Leiter wird mit Schlauchleitungen dauerhaft auf der Leiter betrieben"
    ],
    correct: 1,
    explain: "Für einen zügigen und flexiblen Ablauf werden grundsätzlich alle Steckleiterteile zur Anleiterstelle gebracht. Erst dort entscheidet der Truppführer über die tatsächlich benötigte Anzahl, um Zeitverlust zu vermeiden."
  },
  {
    id: "q027",
    area: "FwDV 10 – Einsatzgrundsätze",
    source: "FwDV 10 Kap. 6",
    text: "Welche Aussage ist als Einsatzgrundsatz für tragbare Leitern korrekt?",
    options: [
      "Leiterfüße dürfen auf Kisten/Steinhaufen aufgesetzt werden, wenn es schneller geht",
      "Leitern müssen nicht gesichert werden, wenn nur eine Person steigt",
      "Leiterfüße dürfen nicht auf ungeeignete Unterlagen; ggf. gegen Wegrutschen/Einsinken sichern",
      "Schlauchleitungen dürfen grundsätzlich auf Leitern verlegt werden"
    ],
    correct: 2,
    explain: "Der Leiterfuß muss auf tragfähigem, geeignetem Untergrund stehen; provisorische Erhöhungen sind gefährlich. Bei Bedarf ist gegen Wegrutschen oder Einsinken zu sichern, um Absturz- und Kippgefahr zu reduzieren."
  },

  // ---------------- FwDV 2 – Brennen & Löschen / Löschmittelwahl ----------------
  {
    id: "q028",
    area: "FwDV 2 – Grundlagen Verbrennung",
    source: "FwDV 2 (Brennen und Löschen)",
    text: "Welche drei Voraussetzungen benötigt eine Verbrennung (klassisch)?",
    options: [
      "Brennstoff – Wasser – Wärme",
      "Sauerstoff – Brennstoff – Zündenergie/Wärme",
      "Rauch – Flamme – Luft",
      "Kohlenstoff – Stickstoff – Wasser"
    ],
    correct: 1,
    explain: "Verbrennung braucht Brennstoff, Sauerstoff und Zündenergie (Wärme). Löschmittel greifen an diesen Voraussetzungen an – z. B. kühlen (Wärme entziehen) oder ersticken (Sauerstoff verdrängen/abdecken)."
  },
  {
    id: "q029",
    area: "FwDV 2 – Brandklassen",
    source: "FwDV 2 (Brennen und Löschen)",
    text: "Welche Brandklasse betrifft brennbare Flüssigkeiten (z. B. Benzin, Alkohol)?",
    options: ["A", "B", "C", "D"],
    correct: 1,
    explain: "Brandklasse B umfasst brennbare Flüssigkeiten und flüssig werdende Stoffe. Taktisch wichtig ist, dass häufig nicht die Flüssigkeit selbst, sondern Dämpfe/Gase brennen und eine Abdeckung mit Schaum sinnvoll ist."
  },
  {
    id: "q030",
    area: "FwDV 2 – Löschmittelwahl",
    source: "FwDV 2 (Brennen und Löschen)",
    text: "Welche Hauptlöschwirkung hat Wasser im Regelfall?",
    options: ["Ersticken", "Kühlen", "Inhibieren", "Neutralisieren"],
    correct: 1,
    explain: "Wasser wirkt hauptsächlich durch Kühlen (Wärmeentzug) und senkt so die Temperatur unter die Zünd-/Entzündungstemperatur. Nebenwirkungen wie Verdampfung/Verdrängung können ergänzend wirken, stehen aber nicht im Vordergrund."
  },

  // ---------------- AAAACEEEE (Gefahren an der Einsatzstelle) ----------------
  {
    id: "q031",
    area: "FwDV 2 – Gefahren (AAAACEEEE)",
    source: "FwDV 2 Kap. 2.2 (Verhalten bei Gefahren)",
    text: "Wofür steht das erste „A“ im AAAACEEEE-Schema typischerweise?",
    options: ["Absturz", "Atemgifte", "Auslaufende Betriebsstoffe", "Angriff"],
    correct: 1,
    explain: "Das Schema dient der systematischen Gefahrenprüfung. Das erste „A“ steht für Atemgifte – ein häufiger, lebensbedrohlicher Faktor, der früh Atemschutz/Eigensicherung beeinflusst."
  },
  {
    id: "q032",
    area: "FwDV 2 – Gefahren (AAAACEEEE)",
    source: "FwDV 2 Kap. 2.2 (Verhalten bei Gefahren)",
    text: "Welcher Buchstabe im AAAACEEEE-Schema steht für „Elektrizität“?",
    options: ["C", "E", "A", "S"],
    correct: 1,
    explain: "„E“ steht für Elektrizität und taucht im Einsatz häufig (Freileitungen, Hausanschlüsse, PV, Bahnanlagen) auf. Maßnahmen sind u. a. Abstand halten, Bereich sichern und Freischalten veranlassen."
  },

  // ---------------- Rettungsgrundsatz / TH ----------------
  {
    id: "q033",
    area: "FwDV 2 – Rettungsgrundsatz (TH)",
    source: "FwDV 2 (Technische Hilfeleistung)",
    text: "Was hat im Einsatz grundsätzlich oberste Priorität?",
    options: ["Sachwerte", "Umweltschutz", "Menschenrettung", "Brandbekämpfung"],
    correct: 2,
    explain: "Menschenrettung hat Vorrang vor allen anderen Zielen. Taktisch bedeutet das: Zugangswege schaffen, lebensrettende Sofortmaßnahmen und zügige Übergabe an den Rettungsdienst, ohne die Eigensicherung zu vernachlässigen."
  },
  {
    id: "q034",
    area: "FwDV 2 – Rettungsgrundsatz (TH)",
    source: "FwDV 2 (Technische Hilfeleistung)",
    text: "Welche Reihenfolge entspricht am ehesten einem sauberen Rettungsvorgehen bei TH (z. B. VU)?",
    options: [
      "Bergen – Retten – Schützen",
      "Sichern – Zugang schaffen – lebensrettende Sofortmaßnahmen – Befreien – Übergabe an RD",
      "Schützen – Bergen – Retten",
      "Löschen – Retten – Bergen"
    ],
    correct: 1,
    explain: "Bei TH beginnt alles mit der Eigensicherung und Einsatzstellensicherung (z. B. Verkehr, Brandschutz, Stabilisierung). Danach folgen Zugang, medizinisch relevante Sofortmaßnahmen, patientengerechtes Befreien und die Übergabe an den Rettungsdienst."
  },

  // ---------------- Schutzabstände elektrische Anlagen ----------------
  {
    id: "q035",
    area: "Elektrische Anlagen – Grundsatz",
    source: "FwDV 2 Kap. 2.2 (Elektrizität) / Praxisregel",
    text: "Warum sind Schutzabstände zu elektrischen Anlagen und Freileitungen so wichtig?",
    options: [
      "Nur wegen Hitzeentwicklung",
      "Wegen möglicher Lichtbögen/Stromüberschlag auch ohne Berührung",
      "Weil Leitungen mechanisch reißen können",
      "Nur wegen Lärm"
    ],
    correct: 1,
    explain: "Bei Hochspannung kann es zu Stromüberschlag/Lichtbogen kommen, auch ohne direkte Berührung. Schutzabstände und Absperrung verhindern, dass Personen oder Geräte in den Gefahrenbereich geraten."
  },
  {
    id: "q036",
    area: "Elektrische Anlagen – Maßnahmen",
    source: "FwDV 2 Kap. 2.2 (Elektrizität) / Praxisregel",
    text: "Welche Maßnahme hat bei einer elektrischen Gefährdung grundsätzlich Vorrang, bevor gezielt gearbeitet wird?",
    options: ["Vollstrahl Wasser abgeben", "Freischalten veranlassen und Bereich sichern", "Metallgeräte ansetzen", "Leitung herunterziehen"],
    correct: 1,
    explain: "Vorrangig ist: Gefahrenbereich absperren und Freischalten durch Betreiber/EVU veranlassen. Erst wenn die Anlage sicher ist (und geerdet/kurzgeschlossen bzw. freigegeben), werden weitere Maßnahmen durchgeführt."
  }
];

// Ampel-Schwellen (prozentual) – anpassbar
const THRESH_GREEN_PCT = 0.90;
const THRESH_YELLOW_PCT = 0.70;

let activeQuestions = [];
let quizOrder = [];
let answers = {};
let started = false;

// ---------- Utilities ----------
function shuffleArray(arr){
  for(let i = arr.length - 1; i > 0; i--){
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}
function sampleWithoutReplacement(arr, n){
  const copy = arr.slice();
  shuffleArray(copy);
  return copy.slice(0, Math.min(n, copy.length));
}
function escapeHtml(s){
  return String(s)
    .replaceAll("&","&amp;")
    .replaceAll("<","&lt;")
    .replaceAll(">","&gt;")
    .replaceAll('"',"&quot;")
    .replaceAll("'","&#039;");
}

// ---------- Tabs ----------
function showTab(tab){
  const quizTab = document.getElementById("quizTab");
  const learnTab = document.getElementById("learnTab");
  const bQuiz = document.getElementById("tabQuiz");
  const bLearn = document.getElementById("tabLearn");

  if(tab === "learn"){
    learnTab.classList.add("active");
    quizTab.style.display = "none";
    bLearn.classList.add("active");
    bQuiz.classList.remove("active");
  } else {
    learnTab.classList.remove("active");
    quizTab.style.display = "block";
    bQuiz.classList.add("active");
    bLearn.classList.remove("active");
  }
}

// ---------- Quiz Lifecycle ----------
function startQuiz(){
  showTab("quiz");
  answers = {};
  started = true;

  const scope = document.getElementById("scope").value; // random16 | all
  const mode = document.getElementById("mode").value;   // exam | learn
  const doShuffle = document.getElementById("shuffle").checked;

  if(scope === "random16"){
    activeQuestions = sampleWithoutReplacement(QUESTIONS_POOL, 16);
  } else {
    activeQuestions = QUESTIONS_POOL.slice();
  }

  quizOrder = activeQuestions.map(q => q.id);
  if(doShuffle) shuffleArray(quizOrder);

  document.getElementById("totalText").textContent = activeQuestions.length.toString();
  document.getElementById("statusText").textContent = (mode === "exam") ? "läuft (Prüfmodus)" : "läuft (Lernmodus)";
  document.getElementById("result").style.display = "none";

  render();
  updateScore(false);
  window.scrollTo({top:0, behavior:"smooth"});
}

function resetAll(){
  started = false;
  answers = {};
  quizOrder = [];
  activeQuestions = [];
  document.getElementById("quiz").innerHTML = "";
  document.getElementById("statusText").textContent = "bereit";
  document.getElementById("scoreText").textContent = "0";
  document.getElementById("totalText").textContent = "0";
  setTraffic(0, 0, false);
  document.getElementById("result").style.display = "none";
}

function setTraffic(score, total, showText){
  const el = document.getElementById("traffic");
  el.classList.remove("red","yellow","green");

  if(!showText || !started || total === 0){
    el.textContent = "ROT";
    el.classList.add("red");
    return;
  }

  const pct = score / total;
  if(pct >= THRESH_GREEN_PCT){
    el.textContent = "GRÜN"; el.classList.add("green");
  } else if(pct >= THRESH_YELLOW_PCT){
    el.textContent = "GELB"; el.classList.add("yellow");
  } else {
    el.textContent = "ROT"; el.classList.add("red");
  }
}

function byIdMap(list){
  return Object.fromEntries(list.map(q => [q.id, q]));
}

function render(){
  const container = document.getElementById("quiz");
  container.innerHTML = "";

  const mode = document.getElementById("mode").value; // exam | learn
  const immediateFeedback = (mode === "learn");

  const order = quizOrder.length ? quizOrder : activeQuestions.map(q => q.id);
  const byId = byIdMap(activeQuestions);

  order.forEach((qid, idx) => {
    const q = byId[qid];

    const qDiv = document.createElement("div");
    qDiv.className = "q";
    qDiv.id = qid;

    const head = document.createElement("div");
    head.className = "qhead";

    const left = document.createElement("div");
    left.style.flex = "1";

    const topLine = document.createElement("div");
    topLine.style.display = "flex";
    topLine.style.gap = "10px";
    topLine.style.alignItems = "baseline";

    const qno = document.createElement("div");
    qno.className = "qno";
    qno.textContent = `Frage ${idx+1}`;

    const qtext = document.createElement("div");
    qtext.className = "qtext";
    qtext.textContent = q.text;

    topLine.appendChild(qno);
    topLine.appendChild(qtext);

    const src = document.createElement("div");
    src.className = "src";
    src.textContent = `Themenbereich: ${q.area} • Hinweis: ${q.source}`;

    left.appendChild(topLine);
    left.appendChild(src);
    head.appendChild(left);
    qDiv.appendChild(head);

    const opts = document.createElement("div");
    opts.className = "opts";

    q.options.forEach((optText, optIdx) => {
      const label = document.createElement("label");
      label.className = "opt";

      const radio = document.createElement("input");
      radio.type = "radio";
      radio.name = qid;
      radio.value = optIdx.toString();
      radio.checked = (answers[qid] === optIdx);

      radio.addEventListener("change", () => {
        answers[qid] = optIdx;
        if(immediateFeedback){
          showFeedback(qid);
        }
        updateScore(true);
      });

      const span = document.createElement("span");
      span.textContent = optText;

      label.appendChild(radio);
      label.appendChild(span);
      opts.appendChild(label);
    });

    qDiv.appendChild(opts);

    const fb = document.createElement("div");
    fb.className = "fb";
    fb.id = qid + "_fb";
    qDiv.appendChild(fb);

    container.appendChild(qDiv);
  });

  // Footer actions
  const footer = document.createElement("div");
  footer.style.display = "flex";
  footer.style.gap = "10px";
  footer.style.flexWrap = "wrap";
  footer.style.marginTop = "10px";

  const btnCheck = document.createElement("button");
  btnCheck.textContent = "Gesamtauswertung anzeigen";
  btnCheck.onclick = finalize;

  const btnHide = document.createElement("button");
  btnHide.textContent = "Feedback ausblenden";
  btnHide.className = "secondary";
  btnHide.onclick = hideAllFeedback;

  footer.appendChild(btnCheck);
  footer.appendChild(btnHide);

  container.appendChild(footer);
}

function showFeedback(qid){
  const q = activeQuestions.find(x => x.id === qid);
  const fb = document.getElementById(qid + "_fb");
  const sel = answers[qid];

  if(sel === undefined){
    fb.style.display = "none";
    fb.className = "fb";
    fb.innerHTML = "";
    return;
  }

  const ok = (sel === q.correct);
  fb.className = "fb " + (ok ? "ok" : "bad");

  const t = document.createElement("div");
  t.className = "t " + (ok ? "ok" : "bad");
  t.textContent = ok ? "Richtig." : "Falsch.";

  const e = document.createElement("div");
  e.className = "e";

  const correctText = q.options[q.correct];
  const yourText = q.options[sel];

  e.innerHTML =
    `<div><b>Deine Antwort:</b> ${escapeHtml(yourText)}</div>` +
    `<div><b>Richtige Antwort:</b> ${escapeHtml(correctText)}</div>` +
    `<div style="margin-top:6px;"><b>Begründung:</b> ${escapeHtml(q.explain)}</div>`;

  fb.innerHTML = "";
  fb.appendChild(t);
  fb.appendChild(e);
}

function hideAllFeedback(){
  activeQuestions.forEach(q => {
    const fb = document.getElementById(q.id + "_fb");
    if(fb){
      fb.style.display = "none";
      fb.className = "fb";
      fb.innerHTML = "";
    }
  });
}

function updateScore(showTraffic){
  let score = 0;
  activeQuestions.forEach(q => {
    if(answers[q.id] === q.correct) score++;
  });

  document.getElementById("scoreText").textContent = score.toString();

  const mode = document.getElementById("mode").value;
  const allowTrafficNow = (mode === "learn") && showTraffic;
  setTraffic(score, activeQuestions.length, allowTrafficNow);
}

function finalize(){
  if(!started || activeQuestions.length === 0) return;

  // Feedback immer anzeigen (Prüfmodus: erst jetzt)
  activeQuestions.forEach(q => showFeedback(q.id));

  let score = 0;
  let answered = 0;
  activeQuestions.forEach(q => {
    if(answers[q.id] !== undefined) answered++;
    if(answers[q.id] === q.correct) score++;
  });

  const total = activeQuestions.length;
  const missing = total - answered;
  const pct = total ? (score / total) : 0;

  let amp = "ROT";
  if(pct >= THRESH_GREEN_PCT) amp = "GRÜN";
  else if(pct >= THRESH_YELLOW_PCT) amp = "GELB";

  const summary = document.getElementById("summary");
  summary.innerHTML =
    `Du hast <b>${score}</b> von <b>${total}</b> Punkten erreicht (Ampel: <b>${amp}</b>).` +
    (missing > 0 ? ` Es fehlen noch <b>${missing}</b> Antworten.` : ``) +
    `<div style="margin-top:8px;">Tipp: Öffne den <b>Lernteil</b> und setze die Checklisten-Haken erst, wenn du die Inhalte sicher erklären/befehlen kannst.</div>`;

  document.getElementById("result").style.display = "block";
  document.getElementById("statusText").textContent = "ausgewertet";

  // Ampel jetzt immer anzeigen
  setTraffic(score, total, true);

  document.getElementById("result").scrollIntoView({behavior:"smooth"});
}

// Initial
resetAll();
</script>
</body>
</html>
